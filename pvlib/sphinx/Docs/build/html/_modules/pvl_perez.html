<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pvl_perez &mdash; PV LIB 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="PV LIB 1.0 documentation" href="../index.html" />
    <link rel="up" title="Module code" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../index.html">PV LIB 1.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for pvl_perez</h1><div class="highlight"><pre>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">pvl_perez</span>
<span class="sd">=========</span>

<span class="sd">Collection of functions for determining diffuse irradiance from the sky on a tilted surface using one of the Perez models</span>

<span class="sd">&#39;&#39;&#39;</span>




<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pvl_tools</span>
    
<div class="viewcode-block" id="pvl_perez"><a class="viewcode-back" href="../stubs/pvl_perez.pvl_perez.html#pvl_perez.pvl_perez">[docs]</a><span class="k">def</span> <span class="nf">pvl_perez</span><span class="p">(</span><span class="n">SurfTilt</span><span class="p">,</span> <span class="n">SurfAz</span><span class="p">,</span> <span class="n">DHI</span><span class="p">,</span> <span class="n">DNI</span><span class="p">,</span> <span class="n">HExtra</span><span class="p">,</span> <span class="n">SunZen</span><span class="p">,</span> <span class="n">SunAz</span><span class="p">,</span> <span class="n">AM</span><span class="p">,</span><span class="n">modelt</span><span class="o">=</span><span class="s">&#39;allsitescomposite1990&#39;</span><span class="p">):</span>
  <span class="sd">&#39;&#39;&#39; </span>
<span class="sd">  Determine diffuse irradiance from the sky on a tilted surface using one of the Perez models</span>

<span class="sd">  Perez models determine the diffuse irradiance from the sky (ground</span>
<span class="sd">  reflected irradiance is not included in this algorithm) on a tilted</span>
<span class="sd">  surface using the surface tilt angle, surface azimuth angle, diffuse</span>
<span class="sd">  horizontal irradiance, direct normal irradiance, extraterrestrial</span>
<span class="sd">  irradiance, sun zenith angle, sun azimuth angle, and relative (not</span>
<span class="sd">  pressure-corrected) airmass. Optionally a selector may be used to use</span>
<span class="sd">  any of Perez&#39;s model coefficient sets.</span>


<span class="sd">  Parameters</span>
<span class="sd">  ----------</span>
<span class="sd">  </span>
<span class="sd">  SurfTilt : float or DataFrame</span>
<span class="sd">          Surface tilt angles in decimal degrees.</span>
<span class="sd">          SurfTilt must be &gt;=0 and &lt;=180. The tilt angle is defined as</span>
<span class="sd">          degrees from horizontal (e.g. surface facing up = 0, surface facing</span>
<span class="sd">          horizon = 90)</span>

<span class="sd">  SurfAz : float or DataFrame</span>
<span class="sd">          Surface azimuth angles in decimal degrees.</span>
<span class="sd">          SurfAz must be &gt;=0 and &lt;=360. The Azimuth convention is defined</span>
<span class="sd">          as degrees east of north (e.g. North = 0, South=180 East = 90, West = 270).</span>

<span class="sd">  DHI : float or DataFrame</span>
<span class="sd">          diffuse horizontal irradiance in W/m^2. </span>
<span class="sd">          DHI must be &gt;=0.</span>

<span class="sd">  DNI : float or DataFrame</span>
<span class="sd">          direct normal irradiance in W/m^2. </span>
<span class="sd">          DNI must be &gt;=0.</span>

<span class="sd">  HExtra : float or DataFrame</span>
<span class="sd">          extraterrestrial normal irradiance in W/m^2. </span>
<span class="sd">           HExtra must be &gt;=0.</span>
<span class="sd">  </span>
<span class="sd">  SunZen : float or DataFrame</span>
<span class="sd">          apparent (refraction-corrected) zenith</span>
<span class="sd">          angles in decimal degrees. </span>
<span class="sd">          SunZen must be &gt;=0 and &lt;=180.</span>

<span class="sd">  SunAz : float or DataFrame</span>
<span class="sd">          Sun azimuth angles in decimal degrees.</span>
<span class="sd">          SunAz must be &gt;=0 and &lt;=360. The Azimuth convention is defined</span>
<span class="sd">          as degrees east of north (e.g. North = 0, East = 90, West = 270).</span>

<span class="sd">  AM : float or DataFrame</span>
<span class="sd">          relative (not pressure-corrected) airmass </span>
<span class="sd">          values. If AM is a DataFrame it must be of the same size as all other </span>
<span class="sd">          DataFrame inputs. AM must be &gt;=0 (careful using the 1/sec(z) model of AM</span>
<span class="sd">          generation)</span>

<span class="sd">  Other Parameters</span>
<span class="sd">  ----------------</span>

<span class="sd">  model : string (optional, default=&#39;allsitescomposite1990&#39;)</span>

<span class="sd">          a character string which selects the desired set of Perez</span>
<span class="sd">          coefficients. If model is not provided as an input, the default,</span>
<span class="sd">          &#39;1990&#39; will be used.</span>
<span class="sd">          All possible model selections are: </span>

<span class="sd">          * &#39;1990&#39;</span>
<span class="sd">          * &#39;allsitescomposite1990&#39; (same as &#39;1990&#39;)</span>
<span class="sd">          * &#39;allsitescomposite1988&#39;</span>
<span class="sd">          * &#39;sandiacomposite1988&#39;</span>
<span class="sd">          * &#39;usacomposite1988&#39;</span>
<span class="sd">          * &#39;france1988&#39;</span>
<span class="sd">          * &#39;phoenix1988&#39;</span>
<span class="sd">          * &#39;elmonte1988&#39;</span>
<span class="sd">          * &#39;osage1988&#39;</span>
<span class="sd">          * &#39;albuquerque1988&#39;</span>
<span class="sd">          * &#39;capecanaveral1988&#39;</span>
<span class="sd">          * &#39;albany1988&#39;</span>

<span class="sd">  Returns</span>
<span class="sd">  --------</span>

<span class="sd">  SkyDiffuse : float or DataFrame</span>

<span class="sd">          the diffuse component of the solar radiation  on an</span>
<span class="sd">          arbitrarily tilted surface defined by the Perez model as given in</span>
<span class="sd">          reference [3].</span>
<span class="sd">          SkyDiffuse is the diffuse component ONLY and does not include the ground</span>
<span class="sd">          reflected irradiance or the irradiance due to the beam.</span>
<span class="sd">      </span>

<span class="sd">  References</span>
<span class="sd">  ----------</span>

<span class="sd">  [1] Loutzenhiser P.G. et. al. &quot;Empirical validation of models to compute</span>
<span class="sd">  solar irradiance on inclined surfaces for building energy simulation&quot;</span>
<span class="sd">  2007, Solar Energy vol. 81. pp. 254-267</span>

<span class="sd">  [2] Perez, R., Seals, R., Ineichen, P., Stewart, R., Menicucci, D., 1987. A new</span>
<span class="sd">  simplified version of the Perez diffuse irradiance model for tilted</span>
<span class="sd">  surfaces. Solar Energy 39(3), 221-232.</span>

<span class="sd">  [3] Perez, R., Ineichen, P., Seals, R., Michalsky, J., Stewart, R., 1990.</span>
<span class="sd">  Modeling daylight availability and irradiance components from direct</span>
<span class="sd">  and global irradiance. Solar Energy 44 (5), 271-289. </span>

<span class="sd">  [4] Perez, R. et. al 1988. &quot;The Development and Verification of the</span>
<span class="sd">  Perez Diffuse Radiation Model&quot;. SAND88-7030</span>

<span class="sd">  See also</span>
<span class="sd">  --------</span>
<span class="sd">  pvl_ephemeris</span>
<span class="sd">  pvl_extraradiation</span>
<span class="sd">  pvl_isotropicsky</span>
<span class="sd">  pvl_haydavies1980</span>
<span class="sd">  pvl_reindl1990</span>
<span class="sd">  pvl_klucher1979</span>
<span class="sd">  pvl_kingdiffuse</span>
<span class="sd">  pvl_relativeairmass</span>

<span class="sd">  &#39;&#39;&#39;</span>
  <span class="n">Vars</span><span class="o">=</span><span class="nb">locals</span><span class="p">()</span>
  <span class="n">Expect</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;SurfTilt&#39;</span><span class="p">:(</span><span class="s">&#39;num&#39;</span><span class="p">,</span><span class="s">&#39;x&gt;=0&#39;</span><span class="p">),</span>
      <span class="s">&#39;SurfAz&#39;</span><span class="p">:(</span><span class="s">&#39;x&gt;=-180&#39;</span><span class="p">),</span>
      <span class="s">&#39;DHI&#39;</span><span class="p">:(</span><span class="s">&#39;x&gt;=0&#39;</span><span class="p">),</span>
      <span class="s">&#39;DNI&#39;</span><span class="p">:(</span><span class="s">&#39;x&gt;=0&#39;</span><span class="p">),</span>
      <span class="s">&#39;HExtra&#39;</span><span class="p">:(</span><span class="s">&#39;x&gt;=0&#39;</span><span class="p">),</span>
      <span class="s">&#39;SunZen&#39;</span><span class="p">:(</span><span class="s">&#39;x&gt;=0&#39;</span><span class="p">),</span>
      <span class="s">&#39;SunAz&#39;</span><span class="p">:(</span><span class="s">&#39;x&gt;=-180&#39;</span><span class="p">),</span>
      <span class="s">&#39;AM&#39;</span><span class="p">:(</span><span class="s">&#39;x&gt;=0&#39;</span><span class="p">),</span>
      <span class="s">&#39;modelt&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s">&#39;default&#39;</span><span class="p">,</span><span class="s">&#39;default=allsitescomposite1990&#39;</span><span class="p">)}</span>

  <span class="n">var</span><span class="o">=</span><span class="n">pvl_tools</span><span class="o">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">Vars</span><span class="p">,</span><span class="n">Expect</span><span class="p">)</span>

  <span class="n">kappa</span> <span class="o">=</span> <span class="mf">1.041</span> <span class="c">#for SunZen in radians</span>
  <span class="n">z</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">SunZen</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="c"># # convert to radians</span>

  <span class="n">Dhfilter</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">DHI</span> <span class="o">&gt;</span> <span class="mi">0</span>
  <span class="n">e</span> <span class="o">=</span> <span class="p">((</span><span class="n">var</span><span class="o">.</span><span class="n">DHI</span><span class="p">[</span><span class="n">Dhfilter</span><span class="p">]</span> <span class="o">+</span> <span class="n">var</span><span class="o">.</span><span class="n">DNI</span><span class="p">[</span><span class="n">Dhfilter</span><span class="p">])</span><span class="o">/</span><span class="n">var</span><span class="o">.</span><span class="n">DHI</span><span class="p">[</span><span class="n">Dhfilter</span><span class="p">]</span><span class="o">+</span><span class="n">kappa</span><span class="o">*</span><span class="n">z</span><span class="p">[</span><span class="n">Dhfilter</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">kappa</span><span class="o">*</span><span class="n">z</span><span class="p">[</span><span class="n">Dhfilter</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">reindex_like</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">SunZen</span><span class="p">)</span>
  <span class="c">#pdb.set_trace()</span>
  <span class="n">ebin</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">DHI</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">index</span><span class="o">=</span><span class="n">e</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

  <span class="c"># Select which bin e falls into</span>
  <span class="n">ebin</span><span class="p">[(</span><span class="n">e</span><span class="o">&lt;</span><span class="mf">1.065</span><span class="p">)]</span><span class="o">=</span> <span class="mi">1</span>
  <span class="n">ebin</span><span class="p">[(</span><span class="n">e</span><span class="o">&gt;=</span><span class="mf">1.065</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e</span><span class="o">&lt;</span><span class="mf">1.23</span><span class="p">)]</span><span class="o">=</span> <span class="mi">2</span>
  <span class="n">ebin</span><span class="p">[(</span><span class="n">e</span><span class="o">&gt;=</span><span class="mf">1.23</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e</span><span class="o">&lt;</span><span class="mf">1.5</span><span class="p">)]</span><span class="o">=</span> <span class="mi">3</span>
  <span class="n">ebin</span><span class="p">[(</span><span class="n">e</span><span class="o">&gt;=</span><span class="mf">1.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e</span><span class="o">&lt;</span><span class="mf">1.95</span><span class="p">)]</span><span class="o">=</span> <span class="mi">4</span>
  <span class="n">ebin</span><span class="p">[(</span><span class="n">e</span><span class="o">&gt;=</span><span class="mf">1.95</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e</span><span class="o">&lt;</span><span class="mf">2.8</span><span class="p">)]</span><span class="o">=</span> <span class="mi">5</span>
  <span class="n">ebin</span><span class="p">[(</span><span class="n">e</span><span class="o">&gt;=</span><span class="mf">2.8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e</span><span class="o">&lt;</span><span class="mf">4.5</span><span class="p">)]</span><span class="o">=</span> <span class="mi">6</span>
  <span class="n">ebin</span><span class="p">[(</span><span class="n">e</span><span class="o">&gt;=</span><span class="mf">4.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">e</span><span class="o">&lt;</span><span class="mf">6.2</span><span class="p">)]</span><span class="o">=</span> <span class="mi">7</span>
  <span class="n">ebin</span><span class="p">[</span><span class="n">e</span><span class="o">&gt;=</span><span class="mf">6.2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>

  <span class="n">ebinfilter</span><span class="o">=</span><span class="n">ebin</span><span class="o">&gt;</span><span class="mi">0</span>
  <span class="n">ebin</span><span class="o">=</span><span class="n">ebin</span><span class="o">-</span><span class="mi">1</span> <span class="c">#correct for 0 indexing</span>
  <span class="n">ebin</span><span class="p">[</span><span class="n">ebinfilter</span><span class="o">==</span><span class="bp">False</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span>
  <span class="n">ebin</span><span class="o">=</span><span class="n">ebin</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

  <span class="c"># This is added because in cases where the sun is below the horizon</span>
  <span class="c"># (var.SunZen &gt; 90) but there is still diffuse horizontal light (var.DHI&gt;0), it is</span>
  <span class="c"># possible that the airmass (var.AM) could be NaN, which messes up later</span>
  <span class="c"># calculations. Instead, if the sun is down, and there is still var.DHI, we set</span>
  <span class="c"># the airmass to the airmass value on the horizon (approximately 37-38).</span>
  <span class="c">#var.AM(var.SunZen &gt;=90 &amp; var.DHI &gt;0) = 37;</span>

  <span class="n">var</span><span class="o">.</span><span class="n">HExtra</span><span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">HExtra</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span><span class="o">=.</span><span class="mo">00000001</span> <span class="c">#very hacky, fix this</span>
  <span class="n">delt</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">DHI</span><span class="o">*</span><span class="n">var</span><span class="o">.</span><span class="n">AM</span><span class="o">/</span><span class="n">var</span><span class="o">.</span><span class="n">HExtra</span>

  <span class="c">#</span>

  <span class="c"># The various possible sets of Perez coefficients are contained</span>
  <span class="c"># in a subfunction to clean up the code.</span>
  <span class="n">F1c</span><span class="p">,</span><span class="n">F2c</span> <span class="o">=</span> <span class="n">GetPerezCoefficients</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">modelt</span><span class="p">)</span>

  <span class="n">F1</span><span class="o">=</span> <span class="n">F1c</span><span class="p">[</span><span class="n">ebin</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">F1c</span><span class="p">[</span><span class="n">ebin</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">delt</span><span class="p">[</span><span class="n">ebinfilter</span><span class="p">]</span> <span class="o">+</span> <span class="n">F1c</span><span class="p">[</span><span class="n">ebin</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">z</span><span class="p">[</span><span class="n">ebinfilter</span><span class="p">]</span>
  <span class="n">F1</span><span class="p">[</span><span class="n">F1</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
  <span class="n">F1</span><span class="o">=</span><span class="n">F1</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

  <span class="n">F2</span><span class="o">=</span> <span class="n">F2c</span><span class="p">[</span><span class="n">ebin</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">F2c</span><span class="p">[</span><span class="n">ebin</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">delt</span><span class="p">[</span><span class="n">ebinfilter</span><span class="p">]</span> <span class="o">+</span> <span class="n">F2c</span><span class="p">[</span><span class="n">ebin</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">z</span><span class="p">[</span><span class="n">ebinfilter</span><span class="p">]</span>
  <span class="n">F2</span><span class="p">[</span><span class="n">F2</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
  <span class="n">F2</span><span class="o">=</span><span class="n">F2</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

  <span class="n">A</span> <span class="o">=</span> <span class="n">pvl_tools</span><span class="o">.</span><span class="n">cosd</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">SurfTilt</span><span class="p">)</span><span class="o">*</span><span class="n">pvl_tools</span><span class="o">.</span><span class="n">cosd</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">SunZen</span><span class="p">)</span> <span class="o">+</span> <span class="n">pvl_tools</span><span class="o">.</span><span class="n">sind</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">SurfTilt</span><span class="p">)</span><span class="o">*</span><span class="n">pvl_tools</span><span class="o">.</span><span class="n">sind</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">SunZen</span><span class="p">)</span><span class="o">*</span><span class="n">pvl_tools</span><span class="o">.</span><span class="n">cosd</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">SunAz</span><span class="o">-</span><span class="n">var</span><span class="o">.</span><span class="n">SurfAz</span><span class="p">);</span> <span class="c">#removed +180 from azimuth modifier: Rob Andrews October 19th 2012</span>
  <span class="n">A</span><span class="p">[</span><span class="n">A</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

  <span class="n">B</span> <span class="o">=</span> <span class="n">pvl_tools</span><span class="o">.</span><span class="n">cosd</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">SunZen</span><span class="p">);</span>
  <span class="n">B</span><span class="p">[</span><span class="n">B</span> <span class="o">&lt;</span> <span class="n">pvl_tools</span><span class="o">.</span><span class="n">cosd</span><span class="p">(</span><span class="mi">85</span><span class="p">)]</span> <span class="o">=</span> <span class="n">pvl_tools</span><span class="o">.</span><span class="n">cosd</span><span class="p">(</span><span class="mi">85</span><span class="p">)</span>


  <span class="c">#Calculate Diffuse POA from sky dome</span>

  <span class="c">#SkyDiffuse = pd.Series(np.zeros(var.DHI.shape[0]),index=data.index)</span>

  <span class="n">SkyDiffuse</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">DHI</span><span class="p">[</span><span class="n">ebinfilter</span><span class="p">]</span><span class="o">*</span><span class="p">(</span> <span class="mf">0.5</span><span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">F1</span><span class="p">[</span><span class="n">ebinfilter</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">pvl_tools</span><span class="o">.</span><span class="n">cosd</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">SurfTilt</span><span class="p">))</span><span class="o">+</span><span class="n">F1</span><span class="p">[</span><span class="n">ebinfilter</span><span class="p">]</span> <span class="o">*</span> <span class="n">A</span><span class="p">[</span><span class="n">ebinfilter</span><span class="p">]</span><span class="o">/</span> <span class="n">B</span><span class="p">[</span><span class="n">ebinfilter</span><span class="p">]</span> <span class="o">+</span> <span class="n">F2</span><span class="p">[</span><span class="n">ebinfilter</span><span class="p">]</span><span class="o">*</span> <span class="n">pvl_tools</span><span class="o">.</span><span class="n">sind</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">SurfTilt</span><span class="p">))</span>
  <span class="n">SkyDiffuse</span><span class="p">[</span><span class="n">SkyDiffuse</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">]</span><span class="o">=</span> <span class="mi">0</span>


  <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;In_Plane_SkyDiffuse&#39;</span><span class="p">:</span><span class="n">SkyDiffuse</span><span class="p">})</span>
</div>
<span class="k">def</span> <span class="nf">GetPerezCoefficients</span><span class="p">(</span><span class="n">perezmodelt</span><span class="p">):</span>
  <span class="sd">&#39;&#39;&#39; </span>
<span class="sd">  Find coefficients for the Perez model </span>

<span class="sd">  Parameters</span>
<span class="sd">  ----------</span>

<span class="sd">  perezmodelt : string (optional, default=&#39;allsitescomposite1990&#39;)</span>

<span class="sd">          a character string which selects the desired set of Perez</span>
<span class="sd">          coefficients. If model is not provided as an input, the default,</span>
<span class="sd">          &#39;1990&#39; will be used.</span>
<span class="sd">  </span>
<span class="sd">  All possible model selections are: </span>

<span class="sd">          * &#39;1990&#39;</span>
<span class="sd">          * &#39;allsitescomposite1990&#39; (same as &#39;1990&#39;)</span>
<span class="sd">          * &#39;allsitescomposite1988&#39;</span>
<span class="sd">          * &#39;sandiacomposite1988&#39;</span>
<span class="sd">          * &#39;usacomposite1988&#39;</span>
<span class="sd">          * &#39;france1988&#39;</span>
<span class="sd">          * &#39;phoenix1988&#39;</span>
<span class="sd">          * &#39;elmonte1988&#39;</span>
<span class="sd">          * &#39;osage1988&#39;</span>
<span class="sd">          * &#39;albuquerque1988&#39;</span>
<span class="sd">          * &#39;capecanaveral1988&#39;</span>
<span class="sd">          * &#39;albany1988&#39;</span>

<span class="sd">  Returns</span>
<span class="sd">  --------</span>

<span class="sd">          F1coeffs : array</span>
<span class="sd">          F1 coefficients for the Perez model</span>
<span class="sd">          F2coeffs : array</span>
<span class="sd">          F2 coefficients for the Perez model        </span>

<span class="sd">  References</span>
<span class="sd">  ----------</span>

<span class="sd">  [1] Loutzenhiser P.G. et. al. &quot;Empirical validation of models to compute</span>
<span class="sd">  solar irradiance on inclined surfaces for building energy simulation&quot;</span>
<span class="sd">  2007, Solar Energy vol. 81. pp. 254-267</span>

<span class="sd">  [2] Perez, R., Seals, R., Ineichen, P., Stewart, R., Menicucci, D., 1987. A new</span>
<span class="sd">  simplified version of the Perez diffuse irradiance model for tilted</span>
<span class="sd">  surfaces. Solar Energy 39(3), 221-232.</span>

<span class="sd">  [3] Perez, R., Ineichen, P., Seals, R., Michalsky, J., Stewart, R., 1990.</span>
<span class="sd">  Modeling daylight availability and irradiance components from direct</span>
<span class="sd">  and global irradiance. Solar Energy 44 (5), 271-289. </span>

<span class="sd">  [4] Perez, R. et. al 1988. &quot;The Development and Verification of the</span>
<span class="sd">  Perez Diffuse Radiation Model&quot;. SAND88-7030</span>

<span class="sd">  &#39;&#39;&#39;</span>
  <span class="n">coeffdict</span><span class="o">=</span> <span class="p">{</span><span class="s">&#39;allsitescomposite1990&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="o">-</span><span class="mf">0.0080</span><span class="p">,</span>    <span class="mf">0.5880</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0620</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0600</span><span class="p">,</span>    <span class="mf">0.0720</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0220</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.1300</span><span class="p">,</span>    <span class="mf">0.6830</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1510</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0190</span><span class="p">,</span>    <span class="mf">0.0660</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0290</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.3300</span><span class="p">,</span>    <span class="mf">0.4870</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2210</span><span class="p">,</span>    <span class="mf">0.0550</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0640</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0260</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.5680</span><span class="p">,</span>    <span class="mf">0.1870</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2950</span><span class="p">,</span>    <span class="mf">0.1090</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1520</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0140</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.8730</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3920</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3620</span><span class="p">,</span>    <span class="mf">0.2260</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.4620</span><span class="p">,</span>    <span class="mf">0.0010</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">1.1320</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.2370</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.4120</span><span class="p">,</span>    <span class="mf">0.2880</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.8230</span><span class="p">,</span>    <span class="mf">0.0560</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">1.0600</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.6000</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3590</span><span class="p">,</span>    <span class="mf">0.2640</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.1270</span><span class="p">,</span>    <span class="mf">0.1310</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.6780</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3270</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2500</span><span class="p">,</span>    <span class="mf">0.1560</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.3770</span><span class="p">,</span>    <span class="mf">0.2510</span><span class="p">]],</span>
             <span class="s">&#39;allsitescomposite1988&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="o">-</span><span class="mf">0.0180</span><span class="p">,</span>    <span class="mf">0.7050</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.071</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0580</span><span class="p">,</span>    <span class="mf">0.1020</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0260</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.1910</span><span class="p">,</span>    <span class="mf">0.6450</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1710</span><span class="p">,</span>    <span class="mf">0.0120</span><span class="p">,</span>    <span class="mf">0.0090</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0270</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.4400</span><span class="p">,</span>    <span class="mf">0.3780</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2560</span><span class="p">,</span>    <span class="mf">0.0870</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1040</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0250</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.7560</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1210</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3460</span><span class="p">,</span>    <span class="mf">0.1790</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3210</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0080</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.9960</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.6450</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.4050</span><span class="p">,</span>    <span class="mf">0.2600</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.5900</span><span class="p">,</span>    <span class="mf">0.0170</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">1.0980</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.2900</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3930</span><span class="p">,</span>    <span class="mf">0.2690</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.8320</span><span class="p">,</span>    <span class="mf">0.0750</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.9730</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.1350</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3780</span><span class="p">,</span>    <span class="mf">0.1240</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2580</span><span class="p">,</span>    <span class="mf">0.1490</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.6890</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.4120</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2730</span><span class="p">,</span>    <span class="mf">0.1990</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.6750</span><span class="p">,</span>    <span class="mf">0.2370</span><span class="p">]],</span>
          
              <span class="s">&#39;sandiacomposite1988&#39;</span><span class="p">:</span>
             <span class="p">[[</span><span class="o">-</span><span class="mf">0.1960</span><span class="p">,</span>    <span class="mf">1.0840</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0060</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1140</span><span class="p">,</span>    <span class="mf">0.1800</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0190</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.2360</span><span class="p">,</span>    <span class="mf">0.5190</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1800</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0110</span><span class="p">,</span>    <span class="mf">0.0200</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0380</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.4540</span><span class="p">,</span>    <span class="mf">0.3210</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2550</span><span class="p">,</span>    <span class="mf">0.0720</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0980</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0460</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.8660</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3810</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3750</span><span class="p">,</span>    <span class="mf">0.2030</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.4030</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0490</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">1.0260</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.7110</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.4260</span><span class="p">,</span>    <span class="mf">0.2730</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.6020</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0610</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.9780</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.9860</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3500</span><span class="p">,</span>    <span class="mf">0.2800</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.9150</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0240</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.7480</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.9130</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2360</span><span class="p">,</span>    <span class="mf">0.1730</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.0450</span><span class="p">,</span>    <span class="mf">0.0650</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.3180</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.7570</span><span class="p">,</span>    <span class="mf">0.1030</span><span class="p">,</span>    <span class="mf">0.0620</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.6980</span><span class="p">,</span>    <span class="mf">0.2360</span><span class="p">]],</span>
              <span class="s">&#39;usacomposite1988&#39;</span><span class="p">:</span>
              <span class="p">[[</span><span class="o">-</span><span class="mf">0.0340</span><span class="p">,</span>    <span class="mf">0.6710</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0590</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0590</span><span class="p">,</span>    <span class="mf">0.0860</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0280</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.2550</span><span class="p">,</span>    <span class="mf">0.4740</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1910</span><span class="p">,</span>    <span class="mf">0.0180</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0140</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0330</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.4270</span><span class="p">,</span>    <span class="mf">0.3490</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2450</span><span class="p">,</span>    <span class="mf">0.0930</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1210</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0390</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.7560</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2130</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3280</span><span class="p">,</span>    <span class="mf">0.1750</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3040</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0270</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">1.0200</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.8570</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3850</span><span class="p">,</span>    <span class="mf">0.2800</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.6380</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0190</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">1.0500</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.3440</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3480</span><span class="p">,</span>    <span class="mf">0.2800</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.8930</span><span class="p">,</span>    <span class="mf">0.0370</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.9740</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.5070</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3700</span><span class="p">,</span>    <span class="mf">0.1540</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.5680</span><span class="p">,</span>    <span class="mf">0.1090</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.7440</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.8170</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2560</span><span class="p">,</span>    <span class="mf">0.2460</span><span class="p">,</span>   <span class="o">-</span><span class="mf">2.6180</span><span class="p">,</span>    <span class="mf">0.2300</span><span class="p">]],</span>
              <span class="s">&#39;france1988&#39;</span><span class="p">:</span>
          
             <span class="p">[[</span><span class="mf">0.0130</span><span class="p">,</span>    <span class="mf">0.7640</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1000</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0580</span><span class="p">,</span>    <span class="mf">0.1270</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0230</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.0950</span><span class="p">,</span>    <span class="mf">0.9200</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1520</span><span class="p">,</span>         <span class="mi">0</span><span class="p">,</span>    <span class="mf">0.0510</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0200</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.4640</span><span class="p">,</span>    <span class="mf">0.4210</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2800</span><span class="p">,</span>    <span class="mf">0.0640</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0510</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0020</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.7590</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0090</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3730</span><span class="p">,</span>    <span class="mf">0.2010</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3820</span><span class="p">,</span>    <span class="mf">0.0100</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.9760</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.4000</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.4360</span><span class="p">,</span>    <span class="mf">0.2710</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.6380</span><span class="p">,</span>    <span class="mf">0.0510</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">1.1760</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.2540</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.4620</span><span class="p">,</span>    <span class="mf">0.2950</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.9750</span><span class="p">,</span>    <span class="mf">0.1290</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">1.1060</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.5630</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3980</span><span class="p">,</span>    <span class="mf">0.3010</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.4420</span><span class="p">,</span>    <span class="mf">0.2120</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.9340</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.5010</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2710</span><span class="p">,</span>    <span class="mf">0.4200</span><span class="p">,</span>   <span class="o">-</span><span class="mf">2.9170</span><span class="p">,</span>    <span class="mf">0.2490</span><span class="p">]],</span>
              <span class="s">&#39;phoenix1988&#39;</span><span class="p">:</span>
            <span class="p">[[</span><span class="o">-</span><span class="mf">0.0030</span><span class="p">,</span>    <span class="mf">0.7280</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0970</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0750</span><span class="p">,</span>    <span class="mf">0.1420</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0430</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.2790</span><span class="p">,</span>    <span class="mf">0.3540</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1760</span><span class="p">,</span>    <span class="mf">0.0300</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0550</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0540</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.4690</span><span class="p">,</span>    <span class="mf">0.1680</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2460</span><span class="p">,</span>    <span class="mf">0.0480</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0420</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0570</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.8560</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.5190</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3400</span><span class="p">,</span>    <span class="mf">0.1760</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3800</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0310</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.9410</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.6250</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3910</span><span class="p">,</span>    <span class="mf">0.1880</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3600</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0490</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">1.0560</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.1340</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.4100</span><span class="p">,</span>    <span class="mf">0.2810</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.7940</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0650</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.9010</span><span class="p">,</span>   <span class="o">-</span><span class="mf">2.1390</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2690</span><span class="p">,</span>    <span class="mf">0.1180</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.6650</span><span class="p">,</span>    <span class="mf">0.0460</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.1070</span><span class="p">,</span>    <span class="mf">0.4810</span><span class="p">,</span>    <span class="mf">0.1430</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1110</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1370</span><span class="p">,</span>    <span class="mf">0.2340</span><span class="p">]],</span>
              <span class="s">&#39;elmonte1988&#39;</span><span class="p">:</span>
              <span class="p">[[</span><span class="mf">0.0270</span><span class="p">,</span>    <span class="mf">0.7010</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1190</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0580</span><span class="p">,</span>    <span class="mf">0.1070</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0600</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.1810</span><span class="p">,</span>    <span class="mf">0.6710</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1780</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0790</span><span class="p">,</span>    <span class="mf">0.1940</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0350</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.4760</span><span class="p">,</span>    <span class="mf">0.4070</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2880</span><span class="p">,</span>    <span class="mf">0.0540</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0320</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0550</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.8750</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2180</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.4030</span><span class="p">,</span>    <span class="mf">0.1870</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3090</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0610</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">1.1660</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.0140</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.4540</span><span class="p">,</span>    <span class="mf">0.2110</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.4100</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0440</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">1.1430</span><span class="p">,</span>   <span class="o">-</span><span class="mf">2.0640</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2910</span><span class="p">,</span>    <span class="mf">0.0970</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3190</span> <span class="p">,</span>   <span class="mf">0.0530</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">1.0940</span><span class="p">,</span>   <span class="o">-</span><span class="mf">2.6320</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2590</span><span class="p">,</span>    <span class="mf">0.0290</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.4220</span> <span class="p">,</span>   <span class="mf">0.1470</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.1550</span><span class="p">,</span>    <span class="mf">1.7230</span><span class="p">,</span>    <span class="mf">0.1630</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1310</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0190</span> <span class="p">,</span>   <span class="mf">0.2770</span><span class="p">]],</span>
              <span class="s">&#39;osage1988&#39;</span><span class="p">:</span>
             <span class="p">[[</span><span class="o">-</span><span class="mf">0.3530</span><span class="p">,</span>    <span class="mf">1.4740</span> <span class="p">,</span>   <span class="mf">0.0570</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1750</span><span class="p">,</span>    <span class="mf">0.3120</span> <span class="p">,</span>   <span class="mf">0.0090</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.3630</span><span class="p">,</span>    <span class="mf">0.2180</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.2120</span><span class="p">,</span>    <span class="mf">0.0190</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0340</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0590</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">0.0310</span><span class="p">,</span>    <span class="mf">1.2620</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0840</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0820</span><span class="p">,</span>    <span class="mf">0.2310</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0170</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.6910</span><span class="p">,</span>    <span class="mf">0.0390</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.2950</span><span class="p">,</span>    <span class="mf">0.0910</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1310</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0350</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">1.1820</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.3500</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.3210</span><span class="p">,</span>    <span class="mf">0.4080</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.9850</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0880</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.7640</span><span class="p">,</span>    <span class="mf">0.0190</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.2030</span><span class="p">,</span>    <span class="mf">0.2170</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2940</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.1030</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.2190</span><span class="p">,</span>    <span class="mf">1.4120</span> <span class="p">,</span>   <span class="mf">0.2440</span><span class="p">,</span>    <span class="mf">0.4710</span><span class="p">,</span>   <span class="o">-</span><span class="mf">2.9880</span> <span class="p">,</span>   <span class="mf">0.0340</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">3.5780</span><span class="p">,</span>   <span class="mf">22.2310</span> <span class="p">,</span> <span class="o">-</span><span class="mf">10.7450</span><span class="p">,</span>    <span class="mf">2.4260</span><span class="p">,</span>    <span class="mf">4.8920</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">5.6870</span><span class="p">]],</span>
              <span class="s">&#39;albuquerque1988&#39;</span><span class="p">:</span>
             <span class="p">[[</span><span class="mf">0.0340</span><span class="p">,</span>    <span class="mf">0.5010</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.0940</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0630</span><span class="p">,</span>    <span class="mf">0.1060</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0440</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.2290</span><span class="p">,</span>    <span class="mf">0.4670</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.1560</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0050</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0190</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0230</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.4860</span><span class="p">,</span>    <span class="mf">0.2410</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.2530</span><span class="p">,</span>    <span class="mf">0.0530</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0640</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0220</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.8740</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3930</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.3970</span><span class="p">,</span>    <span class="mf">0.1810</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3270</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0370</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">1.1930</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.2960</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.5010</span><span class="p">,</span>    <span class="mf">0.2810</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.6560</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0450</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">1.0560</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.7580</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.3740</span><span class="p">,</span>    <span class="mf">0.2260</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.7590</span> <span class="p">,</span>   <span class="mf">0.0340</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.9010</span><span class="p">,</span>   <span class="o">-</span><span class="mf">4.7830</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.1090</span><span class="p">,</span>    <span class="mf">0.0630</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.9700</span> <span class="p">,</span>   <span class="mf">0.1960</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.8510</span><span class="p">,</span>   <span class="o">-</span><span class="mf">7.0550</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.0530</span><span class="p">,</span>    <span class="mf">0.0600</span><span class="p">,</span>   <span class="o">-</span><span class="mf">2.8330</span> <span class="p">,</span>   <span class="mf">0.3300</span><span class="p">]],</span>
              <span class="s">&#39;capecanaveral1988&#39;</span><span class="p">:</span>
             <span class="p">[[</span><span class="mf">0.0750</span><span class="p">,</span>    <span class="mf">0.5330</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1240</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0670</span> <span class="p">,</span>   <span class="mf">0.0420</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0200</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.2950</span><span class="p">,</span>    <span class="mf">0.4970</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2180</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0080</span> <span class="p">,</span>   <span class="mf">0.0030</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0290</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.5140</span><span class="p">,</span>    <span class="mf">0.0810</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2610</span> <span class="p">,</span>   <span class="mf">0.0750</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.1600</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0290</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.7470</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3290</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3250</span> <span class="p">,</span>   <span class="mf">0.1810</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.4160</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0300</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.9010</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.8830</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2970</span> <span class="p">,</span>   <span class="mf">0.1780</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.4890</span> <span class="p">,</span>   <span class="mf">0.0080</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.5910</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0440</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1160</span> <span class="p">,</span>   <span class="mf">0.2350</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.9990</span> <span class="p">,</span>   <span class="mf">0.0980</span><span class="p">],</span>
             <span class="p">[</span> <span class="mf">0.5370</span><span class="p">,</span>   <span class="o">-</span><span class="mf">2.4020</span><span class="p">,</span>    <span class="mf">0.3200</span> <span class="p">,</span>   <span class="mf">0.1690</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">1.9710</span> <span class="p">,</span>   <span class="mf">0.3100</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">0.8050</span><span class="p">,</span>    <span class="mf">4.5460</span><span class="p">,</span>    <span class="mf">1.0720</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.2580</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.9500</span><span class="p">,</span>    <span class="mf">0.7530</span><span class="p">]],</span>
              <span class="s">&#39;albany1988&#39;</span><span class="p">:</span>
             <span class="p">[[</span><span class="mf">0.0120</span><span class="p">,</span>    <span class="mf">0.5540</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0760</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.0520</span><span class="p">,</span>   <span class="mf">0.0840</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0290</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.2670</span><span class="p">,</span>    <span class="mf">0.4370</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1940</span> <span class="p">,</span>  <span class="mf">0.0160</span><span class="p">,</span>   <span class="mf">0.0220</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0360</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.4200</span><span class="p">,</span>    <span class="mf">0.3360</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2370</span> <span class="p">,</span>  <span class="mf">0.0740</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.0520</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0320</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.6380</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.0010</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.2810</span> <span class="p">,</span>  <span class="mf">0.1380</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.1890</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">0.0120</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">1.0190</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.0270</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3420</span> <span class="p">,</span>  <span class="mf">0.2710</span><span class="p">,</span>  <span class="o">-</span><span class="mf">0.6280</span> <span class="p">,</span>   <span class="mf">0.0140</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">1.1490</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.9400</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.3310</span> <span class="p">,</span>  <span class="mf">0.3220</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.0970</span> <span class="p">,</span>   <span class="mf">0.0800</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">1.4340</span><span class="p">,</span>   <span class="o">-</span><span class="mf">3.9940</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.4920</span> <span class="p">,</span>  <span class="mf">0.4530</span><span class="p">,</span>  <span class="o">-</span><span class="mf">2.3760</span> <span class="p">,</span>   <span class="mf">0.1170</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">1.0070</span><span class="p">,</span>   <span class="o">-</span><span class="mf">2.2920</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.4820</span> <span class="p">,</span>  <span class="mf">0.3900</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.3680</span> <span class="p">,</span>   <span class="mf">0.2290</span><span class="p">]],</span>
              <span class="p">}</span>
          
     
  <span class="n">array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coeffdict</span><span class="p">[</span><span class="n">perezmodelt</span><span class="p">])</span>

  <span class="n">F1coeffs</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
  <span class="n">F2coeffs</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>

  <span class="k">return</span> <span class="n">F1coeffs</span> <span class="p">,</span><span class="n">F2coeffs</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li><a href="../index.html">PV LIB 1.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Sandia National Labs.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>